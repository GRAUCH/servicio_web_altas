!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("@fullcalendar/core")):"function"==typeof define&&define.amd?define(["exports","@fullcalendar/core"],factory):(global=global||self,factory(global.FullCalendarDayGrid={},global.FullCalendar))}(this,function(exports,core){"use strict";function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}function isDaySegCollision(seg,otherSegs){var i,otherSeg;for(i=0;i<otherSegs.length;i++)if(otherSeg=otherSegs[i],otherSeg.firstCol<=seg.lastCol&&otherSeg.lastCol>=seg.firstCol)return!0;return!1}function compareDaySegCols(a,b){return a.leftCol-b.leftCol}function renderCellHtml(date,dateProfile,context,otherAttrs){var dateEnv=context.dateEnv,theme=context.theme,isDateValid=core.rangeContainsMarker(dateProfile.activeRange,date),classes=core.getDayClasses(date,dateProfile,context);return classes.unshift("fc-day",theme.getClass("widgetContent")),'<td class="'+classes.join(" ")+'"'+(isDateValid?' data-date="'+dateEnv.formatIso(date,{omitTime:!0})+'"':"")+(otherAttrs?" "+otherAttrs:"")+"></td>"}function buildDayTable(dateProfile,dateProfileGenerator){var daySeries=new core.DaySeries(dateProfile.renderRange,dateProfileGenerator);return new core.DayTable(daySeries,/year|month|week/.test(dateProfile.currentRangeUnit))}var extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},__assign=function(){return __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;n>i;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t},__assign.apply(this,arguments)},DayGridDateProfileGenerator=function(_super){function DayGridDateProfileGenerator(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(DayGridDateProfileGenerator,_super),DayGridDateProfileGenerator.prototype.buildRenderRange=function(currentRange,currentRangeUnit,isRangeAllDay){var endOfWeek,dateEnv=this.dateEnv,renderRange=_super.prototype.buildRenderRange.call(this,currentRange,currentRangeUnit,isRangeAllDay),start=renderRange.start,end=renderRange.end;if(/^(year|month)$/.test(currentRangeUnit)&&(start=dateEnv.startOfWeek(start),endOfWeek=dateEnv.startOfWeek(end),endOfWeek.valueOf()!==end.valueOf()&&(end=core.addWeeks(endOfWeek,1))),this.options.monthMode&&this.options.fixedWeekCount){var rowCnt=Math.ceil(core.diffWeeks(start,end));end=core.addWeeks(end,6-rowCnt)}return{start:start,end:end}},DayGridDateProfileGenerator}(core.DateProfileGenerator),Popover=function(){function Popover(options){var _this=this;this.isHidden=!0,this.margin=10,this.documentMousedown=function(ev){_this.el&&!_this.el.contains(ev.target)&&_this.hide()},this.options=options}return Popover.prototype.show=function(){this.isHidden&&(this.el||this.render(),this.el.style.display="",this.position(),this.isHidden=!1,this.trigger("show"))},Popover.prototype.hide=function(){this.isHidden||(this.el.style.display="none",this.isHidden=!0,this.trigger("hide"))},Popover.prototype.render=function(){var _this=this,options=this.options,el=this.el=core.createElement("div",{className:"fc-popover "+(options.className||""),style:{top:"0",left:"0"}});"function"==typeof options.content&&options.content(el),options.parentEl.appendChild(el),core.listenBySelector(el,"click",".fc-close",function(){_this.hide()}),options.autoHide&&document.addEventListener("mousedown",this.documentMousedown)},Popover.prototype.destroy=function(){this.hide(),this.el&&(core.removeElement(this.el),this.el=null),document.removeEventListener("mousedown",this.documentMousedown)},Popover.prototype.position=function(){var top,left,options=this.options,el=this.el,elDims=el.getBoundingClientRect(),origin=core.computeRect(el.offsetParent),clippingRect=core.computeClippingRect(options.parentEl);top=options.top||0,left=void 0!==options.left?options.left:void 0!==options.right?options.right-elDims.width:0,top=Math.min(top,clippingRect.bottom-elDims.height-this.margin),top=Math.max(top,clippingRect.top+this.margin),left=Math.min(left,clippingRect.right-elDims.width-this.margin),left=Math.max(left,clippingRect.left+this.margin),core.applyStyle(el,{top:top-origin.top,left:left-origin.left})},Popover.prototype.trigger=function(name){this.options[name]&&this.options[name].apply(this,Array.prototype.slice.call(arguments,1))},Popover}(),SimpleDayGridEventRenderer=function(_super){function SimpleDayGridEventRenderer(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SimpleDayGridEventRenderer,_super),SimpleDayGridEventRenderer.prototype.renderSegHtml=function(seg,mirrorInfo){var timeText,titleHtml,context=this.context,eventRange=seg.eventRange,eventDef=eventRange.def,eventUi=eventRange.ui,allDay=eventDef.allDay,isDraggable=core.computeEventDraggable(context,eventDef,eventUi),isResizableFromStart=allDay&&seg.isStart&&core.computeEventStartResizable(context,eventDef,eventUi),isResizableFromEnd=allDay&&seg.isEnd&&core.computeEventEndResizable(context,eventDef,eventUi),classes=this.getSegClasses(seg,isDraggable,isResizableFromStart||isResizableFromEnd,mirrorInfo),skinCss=core.cssToStr(this.getSkinCss(eventUi)),timeHtml="";return classes.unshift("fc-day-grid-event","fc-h-event"),seg.isStart&&(timeText=this.getTimeText(eventRange),timeText&&(timeHtml='<span class="fc-time">'+core.htmlEscape(timeText)+"</span>")),titleHtml='<span class="fc-title">'+(core.htmlEscape(eventDef.title||"")||"&nbsp;")+"</span>",'<a class="'+classes.join(" ")+'"'+(eventDef.url?' href="'+core.htmlEscape(eventDef.url)+'"':"")+(skinCss?' style="'+skinCss+'"':"")+'><div class="fc-content">'+("rtl"===context.options.dir?titleHtml+" "+timeHtml:timeHtml+" "+titleHtml)+"</div>"+(isResizableFromStart?'<div class="fc-resizer fc-start-resizer"></div>':"")+(isResizableFromEnd?'<div class="fc-resizer fc-end-resizer"></div>':"")+"</a>"},SimpleDayGridEventRenderer.prototype.computeEventTimeFormat=function(){return{hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"narrow"}},SimpleDayGridEventRenderer.prototype.computeDisplayEventEnd=function(){return!1},SimpleDayGridEventRenderer}(core.FgEventRenderer),DayGridEventRenderer=function(_super){function DayGridEventRenderer(dayGrid){var _this=_super.call(this)||this;return _this.dayGrid=dayGrid,_this}return __extends(DayGridEventRenderer,_super),DayGridEventRenderer.prototype.attachSegs=function(segs,mirrorInfo){var rowStructs=this.rowStructs=this.renderSegRows(segs);this.dayGrid.rowEls.forEach(function(rowNode,i){rowNode.querySelector(".fc-content-skeleton > table").appendChild(rowStructs[i].tbodyEl)}),mirrorInfo||this.dayGrid.removeSegPopover()},DayGridEventRenderer.prototype.detachSegs=function(){for(var rowStruct,rowStructs=this.rowStructs||[];rowStruct=rowStructs.pop();)core.removeElement(rowStruct.tbodyEl);this.rowStructs=null},DayGridEventRenderer.prototype.renderSegRows=function(segs){var segRows,row,rowStructs=[];for(segRows=this.groupSegRows(segs),row=0;row<segRows.length;row++)rowStructs.push(this.renderSegRow(row,segRows[row]));return rowStructs},DayGridEventRenderer.prototype.renderSegRow=function(row,rowSegs){function emptyCellsUntil(endCol){for(;endCol>col;)td=(loneCellMatrix[i-1]||[])[col],td?td.rowSpan=(td.rowSpan||1)+1:(td=document.createElement("td"),tr.appendChild(td)),cellMatrix[i][col]=td,loneCellMatrix[i][col]=td,col++}var i,levelSegs,col,tr,j,seg,td,isRtl=this.context.isRtl,dayGrid=this.dayGrid,colCnt=dayGrid.colCnt,segLevels=this.buildSegLevels(rowSegs),levelCnt=Math.max(1,segLevels.length),tbody=document.createElement("tbody"),segMatrix=[],cellMatrix=[],loneCellMatrix=[];for(i=0;levelCnt>i;i++){if(levelSegs=segLevels[i],col=0,tr=document.createElement("tr"),segMatrix.push([]),cellMatrix.push([]),loneCellMatrix.push([]),levelSegs)for(j=0;j<levelSegs.length;j++){seg=levelSegs[j];var leftCol=isRtl?colCnt-1-seg.lastCol:seg.firstCol,rightCol=isRtl?colCnt-1-seg.firstCol:seg.lastCol;for(emptyCellsUntil(leftCol),td=core.createElement("td",{className:"fc-event-container"},seg.el),leftCol!==rightCol?td.colSpan=rightCol-leftCol+1:loneCellMatrix[i][col]=td;rightCol>=col;)cellMatrix[i][col]=td,segMatrix[i][col]=seg,col++;tr.appendChild(td)}emptyCellsUntil(colCnt);var introHtml=dayGrid.renderProps.renderIntroHtml();introHtml&&(isRtl?core.appendToElement(tr,introHtml):core.prependToElement(tr,introHtml)),tbody.appendChild(tr)}return{row:row,tbodyEl:tbody,cellMatrix:cellMatrix,segMatrix:segMatrix,segLevels:segLevels,segs:rowSegs}},DayGridEventRenderer.prototype.buildSegLevels=function(segs){var i,seg,j,isRtl=this.context.isRtl,colCnt=this.dayGrid.colCnt,levels=[];for(segs=this.sortEventSegs(segs),i=0;i<segs.length;i++){for(seg=segs[i],j=0;j<levels.length&&isDaySegCollision(seg,levels[j]);j++);seg.level=j,seg.leftCol=isRtl?colCnt-1-seg.lastCol:seg.firstCol,seg.rightCol=isRtl?colCnt-1-seg.firstCol:seg.lastCol,(levels[j]||(levels[j]=[])).push(seg)}for(j=0;j<levels.length;j++)levels[j].sort(compareDaySegCols);return levels},DayGridEventRenderer.prototype.groupSegRows=function(segs){var i,segRows=[];for(i=0;i<this.dayGrid.rowCnt;i++)segRows.push([]);for(i=0;i<segs.length;i++)segRows[segs[i].row].push(segs[i]);return segRows},DayGridEventRenderer.prototype.computeDisplayEventEnd=function(){return 1===this.dayGrid.colCnt},DayGridEventRenderer}(SimpleDayGridEventRenderer),DayGridMirrorRenderer=function(_super){function DayGridMirrorRenderer(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(DayGridMirrorRenderer,_super),DayGridMirrorRenderer.prototype.attachSegs=function(segs,mirrorInfo){var sourceSeg=mirrorInfo.sourceSeg,rowStructs=this.rowStructs=this.renderSegRows(segs);this.dayGrid.rowEls.forEach(function(rowNode,row){var skeletonTopEl,skeletonTop,skeletonEl=core.htmlToElement('<div class="fc-mirror-skeleton"><table></table></div>');sourceSeg&&sourceSeg.row===row?skeletonTopEl=sourceSeg.el:(skeletonTopEl=rowNode.querySelector(".fc-content-skeleton tbody"),skeletonTopEl||(skeletonTopEl=rowNode.querySelector(".fc-content-skeleton table"))),skeletonTop=skeletonTopEl.getBoundingClientRect().top-rowNode.getBoundingClientRect().top,skeletonEl.style.top=skeletonTop+"px",skeletonEl.querySelector("table").appendChild(rowStructs[row].tbodyEl),rowNode.appendChild(skeletonEl)})},DayGridMirrorRenderer}(DayGridEventRenderer),EMPTY_CELL_HTML='<td style="pointer-events:none"></td>',DayGridFillRenderer=function(_super){function DayGridFillRenderer(dayGrid){var _this=_super.call(this)||this;return _this.fillSegTag="td",_this.dayGrid=dayGrid,_this}return __extends(DayGridFillRenderer,_super),DayGridFillRenderer.prototype.renderSegs=function(type,context,segs){"bgEvent"===type&&(segs=segs.filter(function(seg){return seg.eventRange.def.allDay})),_super.prototype.renderSegs.call(this,type,context,segs)},DayGridFillRenderer.prototype.attachSegs=function(type,segs){var i,seg,skeletonEl,els=[];for(i=0;i<segs.length;i++)seg=segs[i],skeletonEl=this.renderFillRow(type,seg),this.dayGrid.rowEls[seg.row].appendChild(skeletonEl),els.push(skeletonEl);return els},DayGridFillRenderer.prototype.renderFillRow=function(type,seg){var className,skeletonEl,trEl,dayGrid=this.dayGrid,isRtl=this.context.isRtl,colCnt=dayGrid.colCnt,leftCol=isRtl?colCnt-1-seg.lastCol:seg.firstCol,rightCol=isRtl?colCnt-1-seg.firstCol:seg.lastCol,startCol=leftCol,endCol=rightCol+1;className="businessHours"===type?"bgevent":type.toLowerCase(),skeletonEl=core.htmlToElement('<div class="fc-'+className+'-skeleton"><table><tr></tr></table></div>'),trEl=skeletonEl.getElementsByTagName("tr")[0],startCol>0&&core.appendToElement(trEl,new Array(startCol+1).join(EMPTY_CELL_HTML)),seg.el.colSpan=endCol-startCol,trEl.appendChild(seg.el),colCnt>endCol&&core.appendToElement(trEl,new Array(colCnt-endCol+1).join(EMPTY_CELL_HTML));var introHtml=dayGrid.renderProps.renderIntroHtml();return introHtml&&(isRtl?core.appendToElement(trEl,introHtml):core.prependToElement(trEl,introHtml)),skeletonEl},DayGridFillRenderer}(core.FillRenderer),DayTile=function(_super){function DayTile(el){var _this=_super.call(this,el)||this,eventRenderer=_this.eventRenderer=new DayTileEventRenderer(_this),renderFrame=_this.renderFrame=core.memoizeRendering(_this._renderFrame);return _this.renderFgEvents=core.memoizeRendering(eventRenderer.renderSegs.bind(eventRenderer),eventRenderer.unrender.bind(eventRenderer),[renderFrame]),_this.renderEventSelection=core.memoizeRendering(eventRenderer.selectByInstanceId.bind(eventRenderer),eventRenderer.unselectByInstanceId.bind(eventRenderer),[_this.renderFgEvents]),_this.renderEventDrag=core.memoizeRendering(eventRenderer.hideByHash.bind(eventRenderer),eventRenderer.showByHash.bind(eventRenderer),[renderFrame]),_this.renderEventResize=core.memoizeRendering(eventRenderer.hideByHash.bind(eventRenderer),eventRenderer.showByHash.bind(eventRenderer),[renderFrame]),_this}return __extends(DayTile,_super),DayTile.prototype.firstContext=function(context){context.calendar.registerInteractiveComponent(this,{el:this.el,useEventCenter:!1})},DayTile.prototype.render=function(props,context){this.renderFrame(props.date),this.renderFgEvents(context,props.fgSegs),this.renderEventSelection(props.eventSelection),this.renderEventDrag(props.eventDragInstances),this.renderEventResize(props.eventResizeInstances)},DayTile.prototype.destroy=function(){_super.prototype.destroy.call(this),this.renderFrame.unrender(),this.context.calendar.unregisterInteractiveComponent(this)},DayTile.prototype._renderFrame=function(date){var _a=this.context,theme=_a.theme,dateEnv=_a.dateEnv,options=_a.options,title=dateEnv.format(date,core.createFormatter(options.dayPopoverFormat));this.el.innerHTML='<div class="fc-header '+theme.getClass("popoverHeader")+'"><span class="fc-title">'+core.htmlEscape(title)+'</span><span class="fc-close '+theme.getIconClass("close")+'"></span></div><div class="fc-body '+theme.getClass("popoverContent")+'"><div class="fc-event-container"></div></div>',this.segContainerEl=this.el.querySelector(".fc-event-container")},DayTile.prototype.queryHit=function(positionLeft,positionTop,elWidth,elHeight){var date=this.props.date;return elWidth>positionLeft&&elHeight>positionTop?{component:this,dateSpan:{allDay:!0,range:{start:date,end:core.addDays(date,1)}},dayEl:this.el,rect:{left:0,top:0,right:elWidth,bottom:elHeight},layer:1}:void 0},DayTile}(core.DateComponent),DayTileEventRenderer=function(_super){function DayTileEventRenderer(dayTile){var _this=_super.call(this)||this;return _this.dayTile=dayTile,_this}return __extends(DayTileEventRenderer,_super),DayTileEventRenderer.prototype.attachSegs=function(segs){for(var _i=0,segs_1=segs;_i<segs_1.length;_i++){var seg=segs_1[_i];this.dayTile.segContainerEl.appendChild(seg.el)}},DayTileEventRenderer.prototype.detachSegs=function(segs){for(var _i=0,segs_2=segs;_i<segs_2.length;_i++){var seg=segs_2[_i];core.removeElement(seg.el)}},DayTileEventRenderer}(SimpleDayGridEventRenderer),DayBgRow=function(){function DayBgRow(context){this.context=context}return DayBgRow.prototype.renderHtml=function(props){var parts=[];props.renderIntroHtml&&parts.push(props.renderIntroHtml());for(var _i=0,_a=props.cells;_i<_a.length;_i++){var cell=_a[_i];parts.push(renderCellHtml(cell.date,props.dateProfile,this.context,cell.htmlAttrs))}return props.cells.length||parts.push('<td class="fc-day '+this.context.theme.getClass("widgetContent")+'"></td>'),"rtl"===this.context.options.dir&&parts.reverse(),"<tr>"+parts.join("")+"</tr>"},DayBgRow}(),DAY_NUM_FORMAT=core.createFormatter({day:"numeric"}),WEEK_NUM_FORMAT=core.createFormatter({week:"numeric"}),DayGrid=function(_super){function DayGrid(el,renderProps){var _this=_super.call(this,el)||this;_this.bottomCoordPadding=0,_this.isCellSizesDirty=!1,_this.renderProps=renderProps;var eventRenderer=_this.eventRenderer=new DayGridEventRenderer(_this),fillRenderer=_this.fillRenderer=new DayGridFillRenderer(_this);_this.mirrorRenderer=new DayGridMirrorRenderer(_this);var renderCells=_this.renderCells=core.memoizeRendering(_this._renderCells,_this._unrenderCells);return _this.renderBusinessHours=core.memoizeRendering(fillRenderer.renderSegs.bind(fillRenderer,"businessHours"),fillRenderer.unrender.bind(fillRenderer,"businessHours"),[renderCells]),_this.renderDateSelection=core.memoizeRendering(fillRenderer.renderSegs.bind(fillRenderer,"highlight"),fillRenderer.unrender.bind(fillRenderer,"highlight"),[renderCells]),_this.renderBgEvents=core.memoizeRendering(fillRenderer.renderSegs.bind(fillRenderer,"bgEvent"),fillRenderer.unrender.bind(fillRenderer,"bgEvent"),[renderCells]),_this.renderFgEvents=core.memoizeRendering(eventRenderer.renderSegs.bind(eventRenderer),eventRenderer.unrender.bind(eventRenderer),[renderCells]),_this.renderEventSelection=core.memoizeRendering(eventRenderer.selectByInstanceId.bind(eventRenderer),eventRenderer.unselectByInstanceId.bind(eventRenderer),[_this.renderFgEvents]),_this.renderEventDrag=core.memoizeRendering(_this._renderEventDrag,_this._unrenderEventDrag,[renderCells]),_this.renderEventResize=core.memoizeRendering(_this._renderEventResize,_this._unrenderEventResize,[renderCells]),_this}return __extends(DayGrid,_super),DayGrid.prototype.render=function(props,context){var cells=props.cells;this.rowCnt=cells.length,this.colCnt=cells[0].length,this.renderCells(cells,props.isRigid),this.renderBusinessHours(context,props.businessHourSegs),this.renderDateSelection(context,props.dateSelectionSegs),this.renderBgEvents(context,props.bgEventSegs),this.renderFgEvents(context,props.fgEventSegs),this.renderEventSelection(props.eventSelection),this.renderEventDrag(props.eventDrag),this.renderEventResize(props.eventResize),this.segPopoverTile&&this.updateSegPopoverTile()},DayGrid.prototype.destroy=function(){_super.prototype.destroy.call(this),this.renderCells.unrender()},DayGrid.prototype.getCellRange=function(row,col){var start=this.props.cells[row][col].date,end=core.addDays(start,1);return{start:start,end:end}},DayGrid.prototype.updateSegPopoverTile=function(date,segs){var ownProps=this.props;this.segPopoverTile.receiveProps({date:date||this.segPopoverTile.props.date,fgSegs:segs||this.segPopoverTile.props.fgSegs,eventSelection:ownProps.eventSelection,eventDragInstances:ownProps.eventDrag?ownProps.eventDrag.affectedInstances:null,eventResizeInstances:ownProps.eventResize?ownProps.eventResize.affectedInstances:null},this.context)},DayGrid.prototype._renderCells=function(cells,isRigid){var row,col,_a=this.context,calendar=_a.calendar,view=_a.view,isRtl=_a.isRtl,dateEnv=_a.dateEnv,_b=this,rowCnt=_b.rowCnt,colCnt=_b.colCnt,html="";for(row=0;rowCnt>row;row++)html+=this.renderDayRowHtml(row,isRigid);for(this.el.innerHTML=html,this.rowEls=core.findElements(this.el,".fc-row"),this.cellEls=core.findElements(this.el,".fc-day, .fc-disabled-day"),isRtl&&this.cellEls.reverse(),this.rowPositions=new core.PositionCache(this.el,this.rowEls,!1,!0),this.colPositions=new core.PositionCache(this.el,this.cellEls.slice(0,colCnt),!0,!1),row=0;rowCnt>row;row++)for(col=0;colCnt>col;col++)calendar.publiclyTrigger("dayRender",[{date:dateEnv.toDate(cells[row][col].date),el:this.getCellEl(row,col),view:view}]);this.isCellSizesDirty=!0},DayGrid.prototype._unrenderCells=function(){this.removeSegPopover()},DayGrid.prototype.renderDayRowHtml=function(row,isRigid){var theme=this.context.theme,classes=["fc-row","fc-week",theme.getClass("dayRow")];isRigid&&classes.push("fc-rigid");var bgRow=new DayBgRow(this.context);return'<div class="'+classes.join(" ")+'"><div class="fc-bg"><table class="'+theme.getClass("tableGrid")+'">'+bgRow.renderHtml({cells:this.props.cells[row],dateProfile:this.props.dateProfile,renderIntroHtml:this.renderProps.renderBgIntroHtml})+'</table></div><div class="fc-content-skeleton"><table>'+(this.getIsNumbersVisible()?"<thead>"+this.renderNumberTrHtml(row)+"</thead>":"")+"</table></div></div>"},DayGrid.prototype.getIsNumbersVisible=function(){return this.getIsDayNumbersVisible()||this.renderProps.cellWeekNumbersVisible||this.renderProps.colWeekNumbersVisible},DayGrid.prototype.getIsDayNumbersVisible=function(){return this.rowCnt>1},DayGrid.prototype.renderNumberTrHtml=function(row){var isRtl=this.context.isRtl,intro=this.renderProps.renderNumberIntroHtml(row,this);return"<tr>"+(isRtl?"":intro)+this.renderNumberCellsHtml(row)+(isRtl?intro:"")+"</tr>"},DayGrid.prototype.renderNumberCellsHtml=function(row){var col,date,htmls=[];for(col=0;col<this.colCnt;col++)date=this.props.cells[row][col].date,htmls.push(this.renderNumberCellHtml(date));return this.context.isRtl&&htmls.reverse(),htmls.join("")},DayGrid.prototype.renderNumberCellHtml=function(date){var classes,weekCalcFirstDow,_a=this.context,dateEnv=_a.dateEnv,options=_a.options,html="",isDateValid=core.rangeContainsMarker(this.props.dateProfile.activeRange,date),isDayNumberVisible=this.getIsDayNumbersVisible()&&isDateValid;return isDayNumberVisible||this.renderProps.cellWeekNumbersVisible?(classes=core.getDayClasses(date,this.props.dateProfile,this.context),classes.unshift("fc-day-top"),this.renderProps.cellWeekNumbersVisible&&(weekCalcFirstDow=dateEnv.weekDow),html+='<td class="'+classes.join(" ")+'"'+(isDateValid?' data-date="'+dateEnv.formatIso(date,{omitTime:!0})+'"':"")+">",this.renderProps.cellWeekNumbersVisible&&date.getUTCDay()===weekCalcFirstDow&&(html+=core.buildGotoAnchorHtml(options,dateEnv,{date:date,type:"week"},{"class":"fc-week-number"},dateEnv.format(date,WEEK_NUM_FORMAT))),isDayNumberVisible&&(html+=core.buildGotoAnchorHtml(options,dateEnv,date,{"class":"fc-day-number"},dateEnv.format(date,DAY_NUM_FORMAT))),html+="</td>"):"<td></td>"},DayGrid.prototype.updateSize=function(isResize){var calendar=this.context.calendar,_a=this,fillRenderer=_a.fillRenderer,eventRenderer=_a.eventRenderer,mirrorRenderer=_a.mirrorRenderer;(isResize||this.isCellSizesDirty||calendar.isEventsUpdated)&&(this.buildPositionCaches(),this.isCellSizesDirty=!1),fillRenderer.computeSizes(isResize),eventRenderer.computeSizes(isResize),mirrorRenderer.computeSizes(isResize),fillRenderer.assignSizes(isResize),eventRenderer.assignSizes(isResize),mirrorRenderer.assignSizes(isResize)},DayGrid.prototype.buildPositionCaches=function(){this.buildColPositions(),this.buildRowPositions()},DayGrid.prototype.buildColPositions=function(){this.colPositions.build()},DayGrid.prototype.buildRowPositions=function(){this.rowPositions.build(),this.rowPositions.bottoms[this.rowCnt-1]+=this.bottomCoordPadding},DayGrid.prototype.positionToHit=function(leftPosition,topPosition){var _a=this,colPositions=_a.colPositions,rowPositions=_a.rowPositions,col=colPositions.leftToIndex(leftPosition),row=rowPositions.topToIndex(topPosition);return null!=row&&null!=col?{row:row,col:col,dateSpan:{range:this.getCellRange(row,col),allDay:!0},dayEl:this.getCellEl(row,col),relativeRect:{left:colPositions.lefts[col],right:colPositions.rights[col],top:rowPositions.tops[row],bottom:rowPositions.bottoms[row]}}:void 0},DayGrid.prototype.getCellEl=function(row,col){return this.cellEls[row*this.colCnt+col]},DayGrid.prototype._renderEventDrag=function(state){state&&(this.eventRenderer.hideByHash(state.affectedInstances),this.fillRenderer.renderSegs("highlight",this.context,state.segs))},DayGrid.prototype._unrenderEventDrag=function(state){state&&(this.eventRenderer.showByHash(state.affectedInstances),this.fillRenderer.unrender("highlight",this.context))},DayGrid.prototype._renderEventResize=function(state){state&&(this.eventRenderer.hideByHash(state.affectedInstances),this.fillRenderer.renderSegs("highlight",this.context,state.segs),this.mirrorRenderer.renderSegs(this.context,state.segs,{isResizing:!0,sourceSeg:state.sourceSeg}))},DayGrid.prototype._unrenderEventResize=function(state){state&&(this.eventRenderer.showByHash(state.affectedInstances),this.fillRenderer.unrender("highlight",this.context),this.mirrorRenderer.unrender(this.context,state.segs,{isResizing:!0,sourceSeg:state.sourceSeg}))},DayGrid.prototype.removeSegPopover=function(){this.segPopover&&this.segPopover.hide()},DayGrid.prototype.limitRows=function(levelLimit){var row,rowLevelLimit,rowStructs=this.eventRenderer.rowStructs||[];for(row=0;row<rowStructs.length;row++)this.unlimitRow(row),rowLevelLimit=levelLimit?"number"==typeof levelLimit?levelLimit:this.computeRowLevelLimit(row):!1,rowLevelLimit!==!1&&this.limitRow(row,rowLevelLimit)},DayGrid.prototype.computeRowLevelLimit=function(row){var i,trEl,rowEl=this.rowEls[row],rowBottom=rowEl.getBoundingClientRect().bottom,trEls=core.findChildren(this.eventRenderer.rowStructs[row].tbodyEl);for(i=0;i<trEls.length;i++)if(trEl=trEls[i],trEl.classList.remove("fc-limited"),trEl.getBoundingClientRect().bottom>rowBottom)return i;return!1},DayGrid.prototype.limitRow=function(row,levelLimit){var levelSegs,cellMatrix,limitedNodes,i,seg,segsBelow,totalSegsBelow,colSegsBelow,td,rowSpan,segMoreNodes,j,moreTd,moreWrap,moreLink,_this=this,colCnt=this.colCnt,isRtl=this.context.isRtl,rowStruct=this.eventRenderer.rowStructs[row],moreNodes=[],col=0,emptyCellsUntil=function(endCol){for(;endCol>col;)segsBelow=_this.getCellSegs(row,col,levelLimit),segsBelow.length&&(td=cellMatrix[levelLimit-1][col],moreLink=_this.renderMoreLink(row,col,segsBelow),moreWrap=core.createElement("div",null,moreLink),td.appendChild(moreWrap),moreNodes.push(moreWrap)),col++};if(levelLimit&&levelLimit<rowStruct.segLevels.length){for(levelSegs=rowStruct.segLevels[levelLimit-1],cellMatrix=rowStruct.cellMatrix,limitedNodes=core.findChildren(rowStruct.tbodyEl).slice(levelLimit),limitedNodes.forEach(function(node){node.classList.add("fc-limited")}),i=0;i<levelSegs.length;i++){seg=levelSegs[i];var leftCol=isRtl?colCnt-1-seg.lastCol:seg.firstCol,rightCol=isRtl?colCnt-1-seg.firstCol:seg.lastCol;for(emptyCellsUntil(leftCol),colSegsBelow=[],totalSegsBelow=0;rightCol>=col;)segsBelow=this.getCellSegs(row,col,levelLimit),colSegsBelow.push(segsBelow),totalSegsBelow+=segsBelow.length,col++;if(totalSegsBelow){for(td=cellMatrix[levelLimit-1][leftCol],rowSpan=td.rowSpan||1,segMoreNodes=[],j=0;j<colSegsBelow.length;j++)moreTd=core.createElement("td",{className:"fc-more-cell",rowSpan:rowSpan}),segsBelow=colSegsBelow[j],moreLink=this.renderMoreLink(row,leftCol+j,[seg].concat(segsBelow)),moreWrap=core.createElement("div",null,moreLink),moreTd.appendChild(moreWrap),segMoreNodes.push(moreTd),moreNodes.push(moreTd);td.classList.add("fc-limited"),core.insertAfterElement(td,segMoreNodes),limitedNodes.push(td)}}emptyCellsUntil(this.colCnt),rowStruct.moreEls=moreNodes,rowStruct.limitedEls=limitedNodes}},DayGrid.prototype.unlimitRow=function(row){var rowStruct=this.eventRenderer.rowStructs[row];rowStruct.moreEls&&(rowStruct.moreEls.forEach(core.removeElement),rowStruct.moreEls=null),rowStruct.limitedEls&&(rowStruct.limitedEls.forEach(function(limitedEl){limitedEl.classList.remove("fc-limited")}),rowStruct.limitedEls=null)},DayGrid.prototype.renderMoreLink=function(row,col,hiddenSegs){var _this=this,_a=this.context,calendar=_a.calendar,view=_a.view,dateEnv=_a.dateEnv,options=_a.options,isRtl=_a.isRtl,a=core.createElement("a",{className:"fc-more"});return a.innerText=this.getMoreLinkText(hiddenSegs.length),a.addEventListener("click",function(ev){var clickOption=options.eventLimitClick,_col=isRtl?_this.colCnt-col-1:col,date=_this.props.cells[row][_col].date,moreEl=ev.currentTarget,dayEl=_this.getCellEl(row,col),allSegs=_this.getCellSegs(row,col),reslicedAllSegs=_this.resliceDaySegs(allSegs,date),reslicedHiddenSegs=_this.resliceDaySegs(hiddenSegs,date);"function"==typeof clickOption&&(clickOption=calendar.publiclyTrigger("eventLimitClick",[{date:dateEnv.toDate(date),allDay:!0,dayEl:dayEl,moreEl:moreEl,segs:reslicedAllSegs,hiddenSegs:reslicedHiddenSegs,jsEvent:ev,view:view}])),"popover"===clickOption?_this.showSegPopover(row,col,moreEl,reslicedAllSegs):"string"==typeof clickOption&&calendar.zoomTo(date,clickOption)}),a},DayGrid.prototype.showSegPopover=function(row,col,moreLink,segs){var topEl,options,_this=this,_a=this.context,calendar=_a.calendar,view=_a.view,theme=_a.theme,isRtl=_a.isRtl,_col=isRtl?this.colCnt-col-1:col,moreWrap=moreLink.parentNode;topEl=1===this.rowCnt?view.el:this.rowEls[row],options={className:"fc-more-popover "+theme.getClass("popover"),parentEl:view.el,top:core.computeRect(topEl).top,autoHide:!0,content:function(el){_this.segPopoverTile=new DayTile(el),_this.updateSegPopoverTile(_this.props.cells[row][_col].date,segs)},hide:function(){_this.segPopoverTile.destroy(),_this.segPopoverTile=null,_this.segPopover.destroy(),_this.segPopover=null}},isRtl?options.right=core.computeRect(moreWrap).right+1:options.left=core.computeRect(moreWrap).left-1,this.segPopover=new Popover(options),this.segPopover.show(),calendar.releaseAfterSizingTriggers()},DayGrid.prototype.resliceDaySegs=function(segs,dayDate){for(var dayStart=dayDate,dayEnd=core.addDays(dayStart,1),dayRange={start:dayStart,end:dayEnd},newSegs=[],_i=0,segs_1=segs;_i<segs_1.length;_i++){var seg=segs_1[_i],eventRange=seg.eventRange,origRange=eventRange.range,slicedRange=core.intersectRanges(origRange,dayRange);slicedRange&&newSegs.push(__assign({},seg,{eventRange:{def:eventRange.def,ui:__assign({},eventRange.ui,{durationEditable:!1}),instance:eventRange.instance,range:slicedRange},isStart:seg.isStart&&slicedRange.start.valueOf()===origRange.start.valueOf(),isEnd:seg.isEnd&&slicedRange.end.valueOf()===origRange.end.valueOf()}))}return newSegs},DayGrid.prototype.getMoreLinkText=function(num){var opt=this.context.options.eventLimitText;return"function"==typeof opt?opt(num):"+"+num+" "+opt},DayGrid.prototype.getCellSegs=function(row,col,startLevel){for(var seg,segMatrix=this.eventRenderer.rowStructs[row].segMatrix,level=startLevel||0,segs=[];level<segMatrix.length;)seg=segMatrix[level][col],seg&&segs.push(seg),level++;return segs},DayGrid}(core.DateComponent),WEEK_NUM_FORMAT$1=core.createFormatter({week:"numeric"}),AbstractDayGridView=function(_super){function AbstractDayGridView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.processOptions=core.memoize(_this._processOptions),_this.renderSkeleton=core.memoizeRendering(_this._renderSkeleton,_this._unrenderSkeleton),_this.renderHeadIntroHtml=function(){var _a=_this.context,theme=_a.theme,options=_a.options;return _this.colWeekNumbersVisible?'<th class="fc-week-number '+theme.getClass("widgetHeader")+'" '+_this.weekNumberStyleAttr()+"><span>"+core.htmlEscape(options.weekLabel)+"</span></th>":""},_this.renderDayGridNumberIntroHtml=function(row,dayGrid){var _a=_this.context,options=_a.options,dateEnv=_a.dateEnv,weekStart=dayGrid.props.cells[row][0].date;return _this.colWeekNumbersVisible?'<td class="fc-week-number" '+_this.weekNumberStyleAttr()+">"+core.buildGotoAnchorHtml(options,dateEnv,{date:weekStart,type:"week",forceOff:1===dayGrid.colCnt},dateEnv.format(weekStart,WEEK_NUM_FORMAT$1))+"</td>":""},_this.renderDayGridBgIntroHtml=function(){var theme=_this.context.theme;return _this.colWeekNumbersVisible?'<td class="fc-week-number '+theme.getClass("widgetContent")+'" '+_this.weekNumberStyleAttr()+"></td>":""},_this.renderDayGridIntroHtml=function(){return _this.colWeekNumbersVisible?'<td class="fc-week-number" '+_this.weekNumberStyleAttr()+"></td>":""},_this}return __extends(AbstractDayGridView,_super),AbstractDayGridView.prototype._processOptions=function(options){options.weekNumbers?options.weekNumbersWithinDays?(this.cellWeekNumbersVisible=!0,this.colWeekNumbersVisible=!1):(this.cellWeekNumbersVisible=!1,this.colWeekNumbersVisible=!0):(this.colWeekNumbersVisible=!1,this.cellWeekNumbersVisible=!1)},AbstractDayGridView.prototype.render=function(props,context){_super.prototype.render.call(this,props,context),this.processOptions(context.options),this.renderSkeleton(context)},AbstractDayGridView.prototype.destroy=function(){_super.prototype.destroy.call(this),this.renderSkeleton.unrender()
},AbstractDayGridView.prototype._renderSkeleton=function(){this.el.classList.add("fc-dayGrid-view"),this.el.innerHTML=this.renderSkeletonHtml(),this.scroller=new core.ScrollComponent("hidden","auto");var dayGridContainerEl=this.scroller.el;this.el.querySelector(".fc-body > tr > td").appendChild(dayGridContainerEl),dayGridContainerEl.classList.add("fc-day-grid-container");var dayGridEl=core.createElement("div",{className:"fc-day-grid"});dayGridContainerEl.appendChild(dayGridEl),this.dayGrid=new DayGrid(dayGridEl,{renderNumberIntroHtml:this.renderDayGridNumberIntroHtml,renderBgIntroHtml:this.renderDayGridBgIntroHtml,renderIntroHtml:this.renderDayGridIntroHtml,colWeekNumbersVisible:this.colWeekNumbersVisible,cellWeekNumbersVisible:this.cellWeekNumbersVisible})},AbstractDayGridView.prototype._unrenderSkeleton=function(){this.el.classList.remove("fc-dayGrid-view"),this.dayGrid.destroy(),this.scroller.destroy()},AbstractDayGridView.prototype.renderSkeletonHtml=function(){var _a=this.context,theme=_a.theme,options=_a.options;return'<table class="'+theme.getClass("tableGrid")+'">'+(options.columnHeader?'<thead class="fc-head"><tr><td class="fc-head-container '+theme.getClass("widgetHeader")+'">&nbsp;</td></tr></thead>':"")+'<tbody class="fc-body"><tr><td class="'+theme.getClass("widgetContent")+'"></td></tr></tbody></table>'},AbstractDayGridView.prototype.weekNumberStyleAttr=function(){return null!=this.weekNumberWidth?'style="width:'+this.weekNumberWidth+'px"':""},AbstractDayGridView.prototype.hasRigidRows=function(){var eventLimit=this.context.options.eventLimit;return eventLimit&&"number"!=typeof eventLimit},AbstractDayGridView.prototype.updateSize=function(isResize,viewHeight,isAuto){_super.prototype.updateSize.call(this,isResize,viewHeight,isAuto),this.dayGrid.updateSize(isResize)},AbstractDayGridView.prototype.updateBaseSize=function(isResize,viewHeight,isAuto){var scrollerHeight,scrollbarWidths,dayGrid=this.dayGrid,eventLimit=this.context.options.eventLimit,headRowEl=this.header?this.header.el:null;return dayGrid.rowEls?(this.colWeekNumbersVisible&&(this.weekNumberWidth=core.matchCellWidths(core.findElements(this.el,".fc-week-number"))),this.scroller.clear(),headRowEl&&core.uncompensateScroll(headRowEl),dayGrid.removeSegPopover(),eventLimit&&"number"==typeof eventLimit&&dayGrid.limitRows(eventLimit),scrollerHeight=this.computeScrollerHeight(viewHeight),this.setGridHeight(scrollerHeight,isAuto),eventLimit&&"number"!=typeof eventLimit&&dayGrid.limitRows(eventLimit),void(isAuto||(this.scroller.setHeight(scrollerHeight),scrollbarWidths=this.scroller.getScrollbarWidths(),(scrollbarWidths.left||scrollbarWidths.right)&&(headRowEl&&core.compensateScroll(headRowEl,scrollbarWidths),scrollerHeight=this.computeScrollerHeight(viewHeight),this.scroller.setHeight(scrollerHeight)),this.scroller.lockOverflow(scrollbarWidths)))):void(isAuto||(scrollerHeight=this.computeScrollerHeight(viewHeight),this.scroller.setHeight(scrollerHeight)))},AbstractDayGridView.prototype.computeScrollerHeight=function(viewHeight){return viewHeight-core.subtractInnerElHeight(this.el,this.scroller.el)},AbstractDayGridView.prototype.setGridHeight=function(height,isAuto){this.context.options.monthMode?(isAuto&&(height*=this.dayGrid.rowCnt/6),core.distributeHeight(this.dayGrid.rowEls,height,!isAuto)):isAuto?core.undistributeHeight(this.dayGrid.rowEls):core.distributeHeight(this.dayGrid.rowEls,height,!0)},AbstractDayGridView.prototype.computeDateScroll=function(){return{top:0}},AbstractDayGridView.prototype.queryDateScroll=function(){return{top:this.scroller.getScrollTop()}},AbstractDayGridView.prototype.applyDateScroll=function(scroll){void 0!==scroll.top&&this.scroller.setScrollTop(scroll.top)},AbstractDayGridView}(core.View);AbstractDayGridView.prototype.dateProfileGeneratorClass=DayGridDateProfileGenerator;var SimpleDayGrid=function(_super){function SimpleDayGrid(dayGrid){var _this=_super.call(this,dayGrid.el)||this;return _this.slicer=new DayGridSlicer,_this.dayGrid=dayGrid,_this}return __extends(SimpleDayGrid,_super),SimpleDayGrid.prototype.firstContext=function(context){context.calendar.registerInteractiveComponent(this,{el:this.dayGrid.el})},SimpleDayGrid.prototype.destroy=function(){_super.prototype.destroy.call(this),this.context.calendar.unregisterInteractiveComponent(this)},SimpleDayGrid.prototype.render=function(props,context){var dayGrid=this.dayGrid,dateProfile=props.dateProfile,dayTable=props.dayTable;dayGrid.receiveProps(__assign({},this.slicer.sliceProps(props,dateProfile,props.nextDayThreshold,context.calendar,dayGrid,dayTable),{dateProfile:dateProfile,cells:dayTable.cells,isRigid:props.isRigid}),context)},SimpleDayGrid.prototype.buildPositionCaches=function(){this.dayGrid.buildPositionCaches()},SimpleDayGrid.prototype.queryHit=function(positionLeft,positionTop){var rawHit=this.dayGrid.positionToHit(positionLeft,positionTop);return rawHit?{component:this.dayGrid,dateSpan:rawHit.dateSpan,dayEl:rawHit.dayEl,rect:{left:rawHit.relativeRect.left,right:rawHit.relativeRect.right,top:rawHit.relativeRect.top,bottom:rawHit.relativeRect.bottom},layer:0}:void 0},SimpleDayGrid}(core.DateComponent),DayGridSlicer=function(_super){function DayGridSlicer(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(DayGridSlicer,_super),DayGridSlicer.prototype.sliceRange=function(dateRange,dayTable){return dayTable.sliceRange(dateRange)},DayGridSlicer}(core.Slicer),DayGridView=function(_super){function DayGridView(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.buildDayTable=core.memoize(buildDayTable),_this}return __extends(DayGridView,_super),DayGridView.prototype.render=function(props,context){_super.prototype.render.call(this,props,context);var dateProfile=this.props.dateProfile,dayTable=this.dayTable=this.buildDayTable(dateProfile,props.dateProfileGenerator);this.header&&this.header.receiveProps({dateProfile:dateProfile,dates:dayTable.headerDates,datesRepDistinctDays:1===dayTable.rowCnt,renderIntroHtml:this.renderHeadIntroHtml},context),this.simpleDayGrid.receiveProps({dateProfile:dateProfile,dayTable:dayTable,businessHours:props.businessHours,dateSelection:props.dateSelection,eventStore:props.eventStore,eventUiBases:props.eventUiBases,eventSelection:props.eventSelection,eventDrag:props.eventDrag,eventResize:props.eventResize,isRigid:this.hasRigidRows(),nextDayThreshold:this.context.nextDayThreshold},context)},DayGridView.prototype._renderSkeleton=function(context){_super.prototype._renderSkeleton.call(this,context),context.options.columnHeader&&(this.header=new core.DayHeader(this.el.querySelector(".fc-head-container"))),this.simpleDayGrid=new SimpleDayGrid(this.dayGrid)},DayGridView.prototype._unrenderSkeleton=function(){_super.prototype._unrenderSkeleton.call(this),this.header&&this.header.destroy(),this.simpleDayGrid.destroy()},DayGridView}(AbstractDayGridView),main=core.createPlugin({defaultView:"dayGridMonth",views:{dayGrid:DayGridView,dayGridDay:{type:"dayGrid",duration:{days:1}},dayGridWeek:{type:"dayGrid",duration:{weeks:1}},dayGridMonth:{type:"dayGrid",duration:{months:1},monthMode:!0,fixedWeekCount:!0}}});exports.AbstractDayGridView=AbstractDayGridView,exports.DayBgRow=DayBgRow,exports.DayGrid=DayGrid,exports.DayGridSlicer=DayGridSlicer,exports.DayGridView=DayGridView,exports.SimpleDayGrid=SimpleDayGrid,exports.buildBasicDayTable=buildDayTable,exports.default=main,Object.defineProperty(exports,"__esModule",{value:!0})});